\input{Preambule}%

\begin{document}
\begin{tikzpicture}[%
    show background rectangle,%
    tight background,%
    background rectangle/.style={fill=white}%
  ]
  \input{Transformer/Connection_Defs.tex}%

  % Phase displacement = 0
  \begin{scope}[local bounding box=Yy0, shift={(0,0)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {y};%
  \end{scope}
  \node[left=0.1 of Yy0] (Yy0 legend) {\textcolor{RoseauBlue}{Yy}0};%
  \begin{scope}[local bounding box=Dd0, shift={(8,0)}]
    \pic at (0,0) {D direct};%
    \pic at (0,-3.5) {d direct};%
  \end{scope}
  \node[left=0.1 of Dd0] (Dd0 legend) {\textcolor{red}{Dd}0};%
  \begin{scope}[local bounding box=Dz0, shift={(16,0)}]
    \pic at (0,0) {D direct};%
    \pic at (0,-3.5) {z direct};%
  \end{scope}
  \node[left=0.1 of Dz0] (Dz0 legend) {\textcolor{red}{D}\textcolor{RoseauGreen}{z}0};%

  % Phase displacement = 1
  \begin{scope}[local bounding box=Yd1, shift={(0,-8)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {d direct};%
  \end{scope}
  \node[left=0.1 of Yd1] (Yd1 legend) {\textcolor{RoseauBlue}{Y}\textcolor{red}{d}1};%
  \begin{scope}[local bounding box=Dy1, shift={(8,-8)}]
    \pic at (0,0) {D inverse};%
    \pic at (0,-3.5) {y};%
  \end{scope}
  \node[left=0.1 of Dy1] (Dy1 legend) {\textcolor{red}{D}\textcolor{RoseauBlue}{y}1};%
  \begin{scope}[local bounding box=Yz1, shift={(16,-8)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {z direct};%
  \end{scope}
  \node[left=0.1 of Yz1] (Yz1 legend) {\textcolor{RoseauBlue}{Y}\textcolor{RoseauGreen}{z}1};%

  % Phase displacement = 5
  \begin{scope}[local bounding box=Yd5, shift={(0,-16)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {d inverse reverse};%
  \end{scope}
  \node[left=0.1 of Yd5] (Yd5 legend) {\textcolor{RoseauBlue}{Y}\textcolor{red}{d}5};%
  \begin{scope}[local bounding box=Dy5, shift={(8,-16)}]
    \pic at (0,0) {D direct};%
    \pic at (0,-3.5) {y reverse};%
  \end{scope}
  \node[left=0.1 of Dy5] (Dy5 legend) {\textcolor{red}{D}\textcolor{RoseauBlue}{y}5};%
  \begin{scope}[local bounding box=Yz5, shift={(16,-16)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {z inverse reverse};%
  \end{scope}
  \node[left=0.1 of Yz5] (Yz5 legend) {\textcolor{RoseauBlue}{Y}\textcolor{RoseauGreen}{z}5};%

  % Phase displacement = 6
  \begin{scope}[local bounding box=Yy6, shift={(0,-24)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {y reverse};%
  \end{scope}
  \node[left=0.1 of Yy6] (Yy6 legend) {\textcolor{RoseauBlue}{Yy}6};%
  \begin{scope}[local bounding box=Dd6, shift={(8,-24)}]
    \pic at (0,0) {D direct};%
    \pic at (0,-3.5) {d direct reverse};%
  \end{scope}
  \node[left=0.1 of Dd6] (Dd6 legend) {\textcolor{red}{Dd}6};%
  \begin{scope}[local bounding box=Dz6, shift={(16,-24)}]
    \pic at (0,0) {D direct};%
    \pic at (0,-3.5) {z direct reverse};%
  \end{scope}
  \node[left=0.1 of Dz6] (Dz6 legend) {\textcolor{red}{D}\textcolor{RoseauGreen}{z}6};%

  % Phase displacement = 11
  \begin{scope}[local bounding box=Yd11, shift={(0,-32)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {d inverse};%
  \end{scope}
  \node[left=0.1 of Yd11] (Yd11 legend) {\textcolor{RoseauBlue}{Y}\textcolor{red}{d}11};%
  \begin{scope}[local bounding box=Dy11, shift={(8,-32)}]
    \pic at (0,0) {D direct};%
    \pic at (0,-3.5) {y};%
  \end{scope}
  \node[left=0.1 of Dy11] (Dy11 legend) {\textcolor{red}{D}\textcolor{RoseauBlue}{y}11};%
  \begin{scope}[local bounding box=Yz11, shift={(16,-32)}]
    \pic at (0,0) {Y};%
    \pic at (0,-3.5) {z inverse};%
  \end{scope}
  \node[left=0.1 of Yz11] (Yz11 legend) {\textcolor{RoseauBlue}{Y}\textcolor{RoseauGreen}{z}11};%

  % Add clock numbers to the left
  \node[left=3.0 of Yy0, node font=\Large] (C0) {0};%
  \node[left=3.0 of Yd1, node font=\Large] (C1) {1};%
  \node[left=3.0 of Yd5, node font=\Large] (C5) {5};%
  \node[left=3.0 of Yy6, node font=\Large] (C6) {6};%
  \node[left=3.0 of Yd11, node font=\Large] (C11) {11};%

  % Add clock numbers coordinates to align the horizontal separators
  \coordinate[left=1.0 of C0] (C0l);%
  \coordinate[left=1.0 of C1] (C1l);%
  \coordinate[left=1.0 of C5] (C5l);%
  \coordinate[left=1.0 of C6] (C6l);%
  \coordinate[left=1.0 of C11] (C11l);%
  \coordinate[right=1.0 of Dz0] (C0r);%
  \coordinate[right=1.0 of Yz1] (C1r);%
  \coordinate[right=1.0 of Yz5] (C5r);%
  \coordinate[right=1.0 of Dz6] (C6r);%
  \coordinate[right=1.0 of Yz11] (C11r);%

  % Add empty anchor nodes to the top-left and the bottom-left corners
  \coordinate[above=3.0 of C0] (tl);%
  \coordinate[below=3.0 of C11] (bl);%

  % Draw horizontal separators
  \draw ($(C0l.south west)!0.5!(C1l.north west)$) -- ($(C0r.south east)!0.5!(C1r.north east)$);%
  \draw ($(C1l.south west)!0.5!(C5l.north west)$) -- ($(C1r.south east)!0.5!(C5r.north east)$);%
  \draw ($(C5l.south west)!0.5!(C6l.north west)$) -- ($(C5r.south east)!0.5!(C6r.north east)$);%
  \draw ($(C6l.south west)!0.5!(C11l.north west)$) -- ($(C6r.south east)!0.5!(C11r.north east)$);%

  % Draw vertical separators
  \draw ($(tl.north east)!0.5!(Yy0.north west)$) -- ($(bl.south east)!0.5!(Yd11.south west)$);%
  \draw ($(Yy0.north east)!0.5!(Dd0.north west)$) -- ($(Yd11.south east)!0.5!(Dy11.south west)$);%
  \draw ($(Dd0.north east)!0.5!(Dz0.north west)$) -- ($(Dy11.south east)!0.5!(Yz11.south west)$);%
\end{tikzpicture}
\end{document}
% Local Variables:
% mode: latex
% TeX-engine: luatex
% TeX-source-correlate-method-active: synctex
% ispell-local-dictionary: "british"
% coding: utf-8
% LaTeX-indent-level: 2
% fill-column: 120
% End:
